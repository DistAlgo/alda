"""
This is a copy of test.da altered for ease of testing for 
our paper with respect to a dataset.

This loads/sets up all of the relevant data except:
-  you need to pass one of RBACpy, RBACda, RBACunion, 
RBACallloc, RBACnonloc as the first argument
- put workload in run method of RBACrun.da

Sample command:
python3.9 -m da --message-buffer-size=40960000 --rule test-paper.da RBACda

"""
import sys, pickle, importlib
from allRBAC import *

def main():
    objs = set()
    ops = set()  
    users = set(range(5000))
    roles = set(range(500))
    pr = set()
    ur = pickle.load(open('input/UR_500','rb'))
    sessions = set()
    su = set()
    sr = set()
    rh = pickle.load(open('input/RH_500','rb'))
  
    ssdnames = set()
    ssdnr = set()
    ssdnc = set()
    
    rbacClass = importlib.import_module(sys.argv[1])
    RBAC = eval('rbacClass.'+sys.argv[1])
    rbac = new(RBAC, [objs,ops,users,roles,pr,ur,sessions,su,sr,rh])

    start(rbac)
